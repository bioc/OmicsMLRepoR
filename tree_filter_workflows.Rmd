---
title: "tree_filter Workflows"
author: "Kaelyn Long"
output: html_document
---

```{r setup}
library(curatedMetagenomicData)
library(OmicsMLRepoR)
library(dplyr)
```

`tree_filter` can be used to perform relatively simple searches involving a
single feature. For example, we can search for any row including a disease
related to either "migraine" or "diabetes."

```{r}
meta <- getMetadata("cMD")
md_or <- meta %>% tree_filter(disease, c("migraine", "diabetes"), "OR")
```

We can also change the "OR" argument to either "AND" or "NOT" in order to change
the default filtering action. "AND" will return any rows including a disease
value that is related to both "migraine" and "diabetes," and "NOT" will return
any rows including a disease value that is not related to either "migraine" or
"diabetes."

```{r}
md_and <- meta %>% tree_filter(disease, c("migraine", "diabetes"), "AND")
md_not <- meta %>% tree_filter(disease, c("migraine", "diabetes"), "NOT")
```

If we want to combine these filtering steps with more complex filtering
functions or filters that do not involve ontology-linked features, we can
extract the resultant values and include them in an argument within dplyr's
native `filter` function. For example, if we want all rows with a disease value
related to either "migraine" or "diabetes," as well as with an age_years value
under 30.

```{r}
or_vals <- unique(md_or$disease)
young_or <- meta %>% filter(age_years < 30 & disease %in% or_vals)
```
